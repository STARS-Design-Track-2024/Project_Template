module FSM(
    input logic clk, rst, Start, Ready_Sig, falling_edge,
    output logic [2:0]state_check,
    output logic Success, Reg_Start, Count_Start
);

    typedef enum logic[2:0] {IDLE, RECEIVING, STOP} turnstile_t;
    turnstile_t current_state, next_state;

    always_ff@(posedge clk, posedge rst) begin
	    if (rst)
		    current_state <= IDLE;
      else 
		    current_state <= next_state;
    end

    always_comb begin
	    case(current_state)
		    IDLE: begin
			    if (falling_edge == 1) begin
				    next_state = RECEIVING;
                end
			    else begin
				    next_state = current_state;
                    Success = 1'b1;
                end
                state_check = current_state;
		    end
		    RECEIVING: begin
                if (falling_edge == 0)begin
                    next_state = STOP;
                end 
                else begin
                    Count_Start = 1;
                    Reg_Start = 1;
                    Success = 0;
                    if (Ready_Sig == 1'b1) begin 
                        next_state = STOP;
                    end
                    else begin
                        next_state = current_state;
                    end
                end
            end
            STOP: begin
                Count_Start = 0;
                Reg_Start = 0;
                Success = 1;
			    next_state = IDLE;
                state_check = current_state;
		    end
        endcase
    end
endmodule